services:
  # Runs on all nodes - checks consistency, provides internal API
  syncwatch:
    image: syncwatch:local
    deploy:
      mode: global
    environment:
      - DATA_PATH=/data
      - SERVICE_NAME=syncwatch
      - DASHBOARD_MODE=false
    volumes:
      - /var/syncthing/data:/data
    networks:
      - syncwatch-net

  # Runs on ONE node (web dashboard)
  dashboard:
    image: syncwatch:local
    ports:
      - "8081:8080"
    environment:
      - DATA_PATH=/data
      - SERVICE_NAME=syncwatch
      - DASHBOARD_MODE=true
    volumes:
      - /var/syncthing/data:/data
    networks:
      - syncwatch-net

networks:
  syncwatch-net:
    driver: overlay